graviton:
    image: graviton/graviton
composer:
    image: composer/composer
    volumes_from:
        - graviton
    environment:
        MONGODB_DB: 'db'
        MONGODB_URI: 'mongodb://mongodb:27017'
    command: install --ignore-platform-reqs --no-dev
    restart: no
prepare:
    image: composer/composer
    volumes_from:
        - graviton
    command: docker_prepare
    restart: no
mongodb:
    image: mongo
    volumes:
        - /var/lib/mongodb:/data
    command: --smallfiles
fpm:
    image: gravityplatform/php-fpm:develop
    links:
        - mongodb:mongodb
    environment:
        MONGODB_DB: 'db'
        MONGODB_URI: 'mongodb://mongodb:27017'
    volumes_from:
        - graviton
nginx:
    image: nginx
    links:
        - fpm:fpm
    volumes:
        - .docker-config/nginx/defaults.conf:/etc/nginx/conf.d/default.conf
    ports:
        - 80:80
