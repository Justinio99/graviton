<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <!--
    <parameters>
{% block parameters %}
        <parameter key="{{ extension_alias }}.example.class">{{ namespace }}\Example</parameter>
{% endblock parameters %}
    </parameters>
    -->
    <services>
{% block services %}
         <!-- pager -->
         <service id="{{ pager_id }}" class="%graviton_rest_pager_standard.class%" parent="graviton_rest_service_pager" scope="request">
         <call method="setRequest">
              <argument type="service" id="request"></argument></call>
         </service>
        <!-- parser -->
          <service id="{{ parser_id }}" class="%graviton_rest_parser_rql.class%" parent="graviton_rest_service_parser" scope="request">
              <call method="setRequest">
              <argument type="service" id="request"></argument></call>
          </service> 
        
        <!-- create the model and set pager / parser. move calls to parent if possible -->
        <service id="{{ model_id }}" class="Graviton\RestBundle\Model\ModelDoctrine" parent="graviton_rest_model" scope="request">
            <argument>{{ entity_path }}</argument>
            <argument>{{ connection_name }}</argument>
            <call method="setPager">
                <argument type="service" id="{{ pager_id }}"></argument>
            </call>
            <call method="setParser">
                <argument type="service" id="{{ parser_id }}"></argument>
            </call>
        </service>
        
        <!-- Create the service and set the model. move action calls to parent if possible -->
        <service id="{{ service_id }}" class="Graviton\RestBundle\Controller\RestController" parent="graviton.rest.controller" scope="request">
            <call method="setModel">
                <argument type="service" id="{{ model_id }}"></argument>
            </call> 
        </service>

         <!-- Create Routing for this service --> 
          <service id="{{ router_id }}" class="Graviton\RestBundle\Routing\Loader\BasicLoader">
            <argument>false</argument>
            <tag name="routing.loader" />
          </service>
{% endblock services %}
    </services>

</container>
